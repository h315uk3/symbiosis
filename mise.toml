# As You Plugin - Development Tools

[tools]
jq = "1.8.1"          # Command-line JSON processor
shellcheck = "0.11.0" # Shell script linter
shfmt = "3.12.0"      # Shell script formatter
rust = "1.92.0"       # Rust toolchain for MCP development

[tasks.test]
description = "Run all tests"
run = "bash tests/run-tests.sh"

[tasks."test:watch"]
description = "Run tests in watch mode"
run = """
while true; do
  clear
  echo "Running tests..."
  bash tests/run-tests.sh
  echo ""
  echo "Waiting for changes... (Ctrl+C to exit)"
  sleep 5
done
"""

[tasks.lint]
description = "Check shell scripts with shellcheck"
run = "shellcheck --exclude=SC1091 scripts/*.sh hooks/*.sh"

[tasks.format]
description = "Format shell scripts with shfmt"
run = "shfmt -w scripts/*.sh hooks/*.sh"

[tasks.validate]
description = "Validate plugin configuration"
run = """
echo "Validating plugin.json..."
jq '.' .claude-plugin/plugin.json > /dev/null && echo "✓ plugin.json is valid"

echo "Validating hooks.json..."
jq '.' hooks/hooks.json > /dev/null && echo "✓ hooks.json is valid"

echo "Running tests..."
bash tests/run-tests.sh
"""

[tasks."scoring:tfidf"]
description = "Calculate TF-IDF scores for all patterns"
run = "bash scripts/calculate-tfidf.sh"

[tasks."scoring:pmi"]
description = "Calculate PMI scores for co-occurrences"
run = "bash scripts/calculate-pmi.sh"

[tasks."scoring:decay"]
description = "Calculate time decay scores for patterns"
run = "bash scripts/calculate-time-decay.sh"

[tasks."scoring:composite"]
description = "Calculate composite scores (runs all scoring)"
run = """
bash scripts/calculate-tfidf.sh &&
bash scripts/calculate-pmi.sh &&
bash scripts/calculate-time-decay.sh &&
bash scripts/calculate-composite-score.sh
"""

# Note: scoring:show, patterns:similar, patterns:merge, patterns:promote have been
# removed as they are now available as slash commands:
#   /as-you:show-scores
#   /as-you:detect-similar-patterns
#   /as-you:merge-patterns
#   (patterns:promote is automatically executed by promote commands)
