# As You Plugin - Development Tools

[tools]
python = "3.13.11"    # Python 3.11+ required (using latest stable)
ruff = "0.14.10"      # Python linter and formatter

[tasks.test]
description = "Run all Python doctests"
run = "python3 tests/run_doctests.py"

[tasks."test:verbose"]
description = "Run Python doctests with verbose output"
run = "python3 tests/run_doctests.py --verbose"

[tasks."test:watch"]
description = "Run tests in watch mode"
run = """
while true; do
  clear
  echo "Running tests..."
  mise run test
  echo ""
  echo "Waiting for changes... (Ctrl+C to exit)"
  sleep 5
done
"""

[tasks.lint]
description = "Lint Python code with ruff"
run = "ruff check plugins/*/as_you plugins/*/with_me"

[tasks.format]
description = "Format Python code with ruff"
run = "ruff format plugins/*/as_you plugins/*/with_me"

[tasks."format:check"]
description = "Check Python formatting without writing"
run = "ruff format --check plugins/*/as_you plugins/*/with_me"

[tasks.validate]
description = "Validate plugin configuration files"
run = "python3 tests/validate_plugins.py"

[tasks."scoring:calculate"]
description = "Calculate all scores (TF-IDF, PMI, time decay, composite)"
env = { PYTHONPATH = "{{config_root}}/plugins/as-you" }
run = "python3 -m as_you.lib.score_calculator"

# Note: Individual scoring tasks (tfidf, pmi, decay, composite) have been unified
# into a single Python implementation (score_calculator.py)
#
# Other scoring and pattern tasks are available as slash commands:
#   /as-you:show-scores
#   /as-you:detect-similar-patterns
#   /as-you:merge-patterns
#   (pattern promotion is automatically executed by promote commands)
